<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>3 · City Rush</title>
<style>
html,body{
  margin:0;
  height:100%;
  overflow:hidden;
  background:linear-gradient(135deg,#e63946 0%,#f77f00 30%,#fcbf49 60%,#eae2b7 100%);
  background-size:300% 300%;
  animation:rushGradient 3s ease-in-out infinite;
}

@keyframes rushGradient{
  0%,100%{background-position:0% 50%;}
  50%{background-position:100% 50%;}
}

/* crosswalk lines */
.crosswalk{
  position:absolute;
  bottom:30%;
  left:0;
  width:100%;
  height:200px;
  display:flex;
  flex-direction:column;
  gap:40px;
  transform:perspective(800px) rotateX(60deg);
}
.line{
  width:100%;
  height:20px;
  background:rgba(255,255,255,0.4);
  animation:slideLines 2s linear infinite;
}
.line:nth-child(2){animation-delay:-0.4s;}
.line:nth-child(3){animation-delay:-0.8s;}
.line:nth-child(4){animation-delay:-1.2s;}
.line:nth-child(5){animation-delay:-1.6s;}

@keyframes slideLines{
  0%{transform:translateY(-100px);opacity:0;}
  20%{opacity:0.4;}
  80%{opacity:0.4;}
  100%{transform:translateY(100px);opacity:0;}
}

/* rushing figures */
.crowd{
  position:absolute;
  bottom:0;
  width:100%;
  height:100%;
  pointer-events:none;
}
.person{
  position:absolute;
  bottom:20%;
  width:40px;
  height:80px;
  background:rgba(40,40,60,0.6);
  border-radius:20px 20px 0 0;
  animation-play-state:paused;
}
.p1{left:-50px;animation:rush1 4s linear infinite;}
.p2{right:-50px;animation:rush2 3.5s linear infinite;}
.p3{left:30%;animation:rush3 5s linear infinite;}
.p4{right:20%;animation:rush4 4.5s linear infinite;}

@keyframes rush1{
  0%{left:-50px;transform:scaleX(1);}
  100%{left:110%;transform:scaleX(1);}
}
@keyframes rush2{
  0%{right:-50px;transform:scaleX(-1);}
  100%{right:110%;transform:scaleX(-1);}
}
@keyframes rush3{
  0%{left:30%;opacity:0.3;}
  50%{opacity:0.7;}
  100%{left:110%;opacity:0.3;}
}
@keyframes rush4{
  0%{right:20%;opacity:0.4;}
  50%{opacity:0.8;}
  100%{right:110%;opacity:0.4;}
}

/* pulsing circles for intensity */
.pulse{
  position:absolute;
  width:300px;
  height:300px;
  border:3px solid rgba(255,255,255,0.4);
  border-radius:50%;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  animation:pulseOut 2s ease-out infinite;
  pointer-events:none;
}
.pulse:nth-child(2){animation-delay:0.6s;}
.pulse:nth-child(3){animation-delay:1.2s;}

@keyframes pulseOut{
  0%{transform:translate(-50%,-50%) scale(0.3);opacity:0.8;}
  100%{transform:translate(-50%,-50%) scale(1.5);opacity:0;}
}

/* breathe circle - user controlled */
.breathe{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  width:150px;
  height:150px;
  border:4px solid rgba(255,255,255,0.7);
  border-radius:50%;
  background:rgba(255,255,255,0.1);
  backdrop-filter:blur(10px);
  transition:all 0.8s ease-out;
  z-index:50;
  box-shadow:0 0 20px rgba(255,255,255,0.3);
}
.breathe.expand{
  width:350px;
  height:350px;
  background:rgba(255,255,255,0.3);
  border-color:rgba(255,255,255,0.9);
  box-shadow:0 0 60px rgba(255,255,255,0.6);
}

/* instruction */
.instruction{
  position:absolute;
  top:30%;
  left:50%;
  transform:translateX(-50%);
  text-align:center;
  color:rgba(255,255,255,0.9);
  font-family:'Inter',sans-serif;
  font-size:1.1rem;
  font-weight:300;
  letter-spacing:1px;
  pointer-events:none;
  text-shadow:0 2px 10px rgba(0,0,0,0.4);
}
.subtitle{
  font-size:0.85rem;
  margin-top:8px;
  opacity:0.8;
}

/* nav */
.nav{
  position:fixed;
  bottom:25px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:25px;
  z-index:100;
}
.nav a{
  text-decoration:none;
  padding:10px 16px;
  border-radius:20px;
  background:rgba(255,255,255,0.7);
  color:#333;
  font-family:'Inter',sans-serif;
  font-size:.9rem;
  transition:.3s;
  backdrop-filter:blur(10px);
}
.nav a:hover{background:rgba(255,255,255,0.95);}

body.rushing .person{
  animation-play-state:running;
}
body.paused .person{
  animation-play-state:paused;
}
</style>
</head>
<body>
<div class="crosswalk">
  <div class="line"></div>
  <div class="line"></div>
  <div class="line"></div>
  <div class="line"></div>
  <div class="line"></div>
</div>

<div class="crowd">
  <div class="person p1"></div>
  <div class="person p2"></div>
  <div class="person p3"></div>
  <div class="person p4"></div>
</div>

<div class="pulse"></div>
<div class="pulse"></div>
<div class="pulse"></div>

<div class="breathe" id="breathe"></div>

<div class="instruction">
  SPACE to rush · HOLD CLICK to breathe
  <div class="subtitle">tension between rushing and trying to breathe</div>
</div>

<div class="nav">
  <a href="entry2.html">← Back</a>
  <a href="entry4.html">Next →</a>
</div>

<script>
const breatheCircle = document.getElementById('breathe');

// Space bar controls crowd movement
document.addEventListener('keydown', (e) => {
  if (e.code === 'Space') {
    e.preventDefault();
    document.body.classList.toggle('rushing');
  }
});

// Hold click to breathe - expand circle and pause movement
document.addEventListener('mousedown', (e) => {
  if (e.target.tagName !== 'A') {
    breatheCircle.classList.add('expand');
    document.body.classList.add('paused');
  }
});

document.addEventListener('mouseup', () => {
  breatheCircle.classList.remove('expand');
  document.body.classList.remove('paused');
});

document.addEventListener('mouseleave', () => {
  breatheCircle.classList.remove('expand');
  document.body.classList.remove('paused');
});
</script>
</body>
</html>